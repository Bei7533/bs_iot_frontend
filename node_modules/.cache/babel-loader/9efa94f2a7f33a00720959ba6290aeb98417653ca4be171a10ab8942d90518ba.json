{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nexport default {\n  data() {\n    return {\n      username: '',\n      email: '',\n      password: '',\n      userDescipt: '',\n      activeIndex: '1',\n      activeIndex2: '1',\n      editContent: '',\n      tableData: [],\n      editRow: '',\n      editIndex: 0,\n      dialogFormVisible: false,\n      passwordDialogVisible: false,\n      exitVisible: false,\n      comfirmPassword: '',\n      newPassword: '',\n      newPasswordAgain: ''\n    };\n  },\n  mounted() {\n    this.fetchData();\n  },\n  methods: {\n    fetchData() {\n      console.log('fetch');\n      if (this.username === '') this.username = this.$route.query.username;\n      this.$axios.post('http://localhost:8088/admin/userinfo', {\n        username: this.username\n      }).then(successResponse => {\n        if (successResponse.data.code === 200) {\n          this.email = successResponse.data.userInfo.email;\n          this.password = successResponse.data.userInfo.password;\n          this.userDescipt = successResponse.data.userInfo.user_descript;\n          // console.log(this.userDescipt)\n          this.tableData = [{\n            type: '用户名',\n            data: this.username\n          }, {\n            type: '邮箱',\n            data: this.email\n          }, {\n            type: '个人描述',\n            data: this.userDescipt\n          }];\n        } else if (successResponse.data.code === 404) {\n          alert('访问用户失败');\n        }\n      }).catch(failResponse => {});\n    },\n    handleSelect(key, keyPath) {\n      console.log(key, keyPath);\n      if (key === '1-1') {\n        this.$router.push({\n          path: '/user/userinfo',\n          query: {\n            username: this.username\n          }\n        });\n      } else if (key === '1-2') {\n        // this.$router.push({\n        //   path: '/user/edituserinfo',\n        //   query: { username: this.username }\n        // });\n      } else if (key === '1-3') {\n        this.$router.push({\n          path: '/UserHome',\n          query: {\n            username: this.username\n          }\n        });\n      } else if (key === '2') {\n        this.$router.push({\n          path: '/user/map',\n          query: {\n            username: this.username\n          }\n        });\n      } else if (key === '3') {\n        this.$router.push({\n          path: '/user/device',\n          query: {\n            username: this.username\n          }\n        });\n      } else if (key === '4') {\n        this.$router.push({\n          path: '/user/data',\n          query: {\n            username: this.username\n          }\n        });\n      }\n    },\n    handleEditButton(index, row) {\n      this.editRow = \"请输入你的新\" + row.type;\n      this.editIndex = index;\n      this.dialogFormVisible = true;\n      console.log(this.editRow);\n    },\n    handleEdit() {\n      if (this.editContent === '') {\n        alert('输入不能为空');\n        return;\n      }\n      this.dialogFormVisible = false;\n      this.tableData[this.editIndex].data = this.editContent;\n      this.$axios.post('http://localhost:8088/admin/userinfoedit', {\n        username: this.username,\n        editContent: this.editContent,\n        editIndex: this.editIndex\n      }).then(successResponse => {\n        if (successResponse.data.code === 200) {\n          console.log(this.username);\n          const username_ = this.username;\n          console.log(username_);\n          alert('修改成功');\n          console.log(this.editIndex);\n          if (this.editIndex === 1) this.email = this.editContent;else if (this.editIndex === 2) this.userDescipt = this.editContent;else if (this.editIndex === 0) this.username = this.editContent;\n          if (this.editIndex !== 0) {\n            this.username = username_;\n          }\n          console.log(this.username);\n        } else if (successResponse.data.code === 250) {\n          alert('用户名已经存在');\n        }\n      }).catch(failResponse => {});\n      this.editRow = '';\n      this.editIndex = 0;\n      this.editContent = '';\n    },\n    handleEditPassword() {\n      if (this.comfirmPassword === '' || this.newPassword === '' || this.newPasswordAgain === '') {\n        alert('输入不能为空');\n        return;\n      }\n      if (this.password !== this.comfirmPassword) {\n        alert('原始密码错误');\n        return;\n      }\n      if (this.password === this.newPassword) {\n        alert('新密码不能与原始密码相同');\n        return;\n      }\n      if (this.newPassword !== this.newPasswordAgain) {\n        alert('两次输入的密码不一致');\n        return;\n      }\n      this.$axios.post('http://localhost:8088/admin/userinfoedit', {\n        username: this.username,\n        editContent: this.newPassword,\n        editIndex: 5\n      }).then(successResponse => {\n        if (successResponse.data.code === 200) {\n          alert('修改成功');\n          this.password = this.newPassword;\n        } else if (successResponse.data.code === 250) {\n          alert('原始密码错误');\n        }\n      }).catch(failResponse => {});\n      this.passwordDialogVisible = false;\n    },\n    handleExit() {\n      this.$router.push({\n        path: '/login'\n      });\n    }\n  }\n};","map":{"version":3,"names":["data","username","email","password","userDescipt","activeIndex","activeIndex2","editContent","tableData","editRow","editIndex","dialogFormVisible","passwordDialogVisible","exitVisible","comfirmPassword","newPassword","newPasswordAgain","mounted","fetchData","methods","console","log","$route","query","$axios","post","then","successResponse","code","userInfo","user_descript","type","alert","catch","failResponse","handleSelect","key","keyPath","$router","push","path","handleEditButton","index","row","handleEdit","username_","handleEditPassword","handleExit"],"sources":["src/views/user/UserInfoEdit.vue"],"sourcesContent":["<script>\r\nexport default {\r\n    data() {\r\n        return {\r\n            username: '',\r\n            email: '',\r\n            password: '',\r\n            userDescipt: '',\r\n            activeIndex: '1',\r\n            activeIndex2: '1',\r\n            editContent: '',\r\n            tableData: [],\r\n            editRow: '',\r\n            editIndex: 0,\r\n            dialogFormVisible: false,\r\n            passwordDialogVisible: false,\r\n            exitVisible: false,\r\n            comfirmPassword: '',\r\n            newPassword: '',\r\n            newPasswordAgain: '',\r\n        }\r\n    },\r\n    mounted() {\r\n        this.fetchData();\r\n    },\r\n    methods: {\r\n        fetchData() {\r\n          console.log('fetch')\r\n          if(this.username === '')\r\n            this.username = this.$route.query.username;\r\n          this.$axios\r\n              .post('http://localhost:8088/admin/userinfo', {\r\n                  username: this.username,\r\n              })\r\n              .then(successResponse => {\r\n                  if (successResponse.data.code === 200) {\r\n                      this.email = successResponse.data.userInfo.email;\r\n                      this.password = successResponse.data.userInfo.password;\r\n                      this.userDescipt = successResponse.data.userInfo.user_descript;\r\n                      // console.log(this.userDescipt)\r\n                      this.tableData = [\r\n                          {\r\n                              type: '用户名',\r\n                              data: this.username,\r\n                          },\r\n                          {\r\n                              type: '邮箱',\r\n                              data: this.email,\r\n                          },\r\n                          {\r\n                              type: '个人描述',\r\n                              data: this.userDescipt,\r\n                          }\r\n                      ]\r\n                  } else if (successResponse.data.code === 404) {\r\n                      alert('访问用户失败')\r\n                  }\r\n              })\r\n              .catch(failResponse => {\r\n              });\r\n\r\n        },\r\n\r\n        handleSelect(key, keyPath) {\r\n            console.log(key, keyPath);\r\n            if (key === '1-1') {\r\n                this.$router.push({\r\n                    path: '/user/userinfo',\r\n                    query: { username: this.username }\r\n                });\r\n            } else if (key === '1-2') {\r\n                // this.$router.push({\r\n                //   path: '/user/edituserinfo',\r\n                //   query: { username: this.username }\r\n                // });\r\n            } else if (key === '1-3') {\r\n              this.$router.push({\r\n                path: '/UserHome',\r\n                query: { username: this.username }\r\n              });\r\n            } else if (key === '2') {\r\n                this.$router.push({\r\n                    path: '/user/map',\r\n                    query: { username: this.username }\r\n                });\r\n            } else if (key === '3') {\r\n                this.$router.push({\r\n                    path: '/user/device',\r\n                    query: { username: this.username }\r\n                });\r\n            } else if (key === '4') {\r\n                this.$router.push({\r\n                    path: '/user/data',\r\n                    query: { username: this.username }\r\n                });\r\n            }\r\n        },\r\n\r\n        handleEditButton(index, row) {\r\n            this.editRow = \"请输入你的新\" + row.type;\r\n            this.editIndex = index;\r\n            this.dialogFormVisible = true;\r\n            console.log(this.editRow);\r\n        },\r\n\r\n        handleEdit() {\r\n            if (this.editContent === '') {\r\n                alert('输入不能为空')\r\n                return\r\n            }\r\n            this.dialogFormVisible = false;\r\n            this.tableData[this.editIndex].data = this.editContent;\r\n            this.$axios\r\n                .post('http://localhost:8088/admin/userinfoedit', {\r\n                    username: this.username,\r\n                    editContent: this.editContent,\r\n                    editIndex: this.editIndex,\r\n                })\r\n                .then(successResponse => {\r\n                    if (successResponse.data.code === 200) {\r\n                      console.log(this.username)\r\n\r\n                      const username_ = this.username;\r\n                      console.log(username_)\r\n\r\n                      alert('修改成功')\r\n                      console.log(this.editIndex)\r\n                        if (this.editIndex === 1) this.email = this.editContent;\r\n                        else if (this.editIndex === 2) this.userDescipt = this.editContent;\r\n                        else if (this.editIndex === 0)\r\n                            this.username = this.editContent;\r\n\r\n                        if (this.editIndex !== 0 ){\r\n                          this.username = username_;\r\n                        }\r\n                        console.log(this.username)\r\n                    } else if (successResponse.data.code === 250) {\r\n                        alert('用户名已经存在')\r\n                    }\r\n                })\r\n                .catch(failResponse => {\r\n                })\r\n            this.editRow = ''\r\n            this.editIndex = 0\r\n            this.editContent = ''\r\n        },\r\n        handleEditPassword() {\r\n            if (this.comfirmPassword === '' || this.newPassword === '' || this.newPasswordAgain === '') {\r\n                alert('输入不能为空')\r\n                return\r\n            }\r\n            if (this.password !== this.comfirmPassword) {\r\n                alert('原始密码错误')\r\n                return\r\n            }\r\n            if (this.password === this.newPassword) {\r\n                alert('新密码不能与原始密码相同')\r\n                return\r\n            }\r\n            if (this.newPassword !== this.newPasswordAgain) {\r\n                alert('两次输入的密码不一致')\r\n                return\r\n            }\r\n            this.$axios\r\n                .post('http://localhost:8088/admin/userinfoedit', {\r\n                    username: this.username,\r\n                    editContent: this.newPassword,\r\n                    editIndex: 5,\r\n                })\r\n                .then(successResponse => {\r\n                    if (successResponse.data.code === 200) {\r\n                        alert('修改成功')\r\n                        this.password = this.newPassword;\r\n                    } else if (successResponse.data.code === 250) {\r\n                        alert('原始密码错误')\r\n                    }\r\n                })\r\n                .catch(failResponse => {\r\n                })\r\n          this.passwordDialogVisible = false;\r\n        },\r\n        handleExit() {\r\n            this.$router.push({\r\n                path: '/login',\r\n            });\r\n        }\r\n\r\n    }\r\n\r\n}\r\n</script>\r\n\r\n<template>\r\n    <div class=\"body\">\r\n\r\n        <el-menu :default-active=\"activeIndex2\" class=\"el-menu-demo\" mode=\"horizontal\" @select=\"handleSelect\"\r\n            background-color=\"#2A7A88\" text-color=\"#fff\" active-text-color=\"#ffd04b\">\r\n            <el-submenu index=\"1\">\r\n                <template slot=\"title\">\r\n                    <i class=\"el-icon-user\"></i>\r\n                    <span>个人信息</span>\r\n                </template>\r\n                <el-menu-item index=\"1-1\">查看信息</el-menu-item>\r\n                <el-menu-item index=\"1-2\">编辑信息</el-menu-item>\r\n                <el-menu-item index=\"1-3\">回到首页</el-menu-item>\r\n            </el-submenu>\r\n            <el-menu-item index=\"2\">\r\n                <template slot=\"title\">\r\n                    <i class=\"el-icon-map-location\"></i>\r\n                    <span slot=\"title\">查看地图</span>\r\n                </template>\r\n            </el-menu-item>\r\n            <el-menu-item index=\"3\">\r\n                <i class=\"el-icon-setting\"></i>\r\n                <span slot=\"title\">设备管理</span>\r\n            </el-menu-item>\r\n            <el-menu-item index=\"4\">\r\n                <i class=\"el-icon-data-line\"></i>\r\n                <span slot=\"title\">数据统计</span>\r\n            </el-menu-item>\r\n            <el-button size=\"mini\" @click=\"exitVisible = true\" class=\"exit-style\">退出登录</el-button>\r\n        </el-menu>\r\n\r\n        <el-dialog title=\"确认退出登录？\" :visible.sync=\"exitVisible\" width=\"30%\" :before-close=\"handleExit\">\r\n            <div slot=\"footer\" class=\"dialog-footer\">\r\n                <el-button @click=\"exitVisible = false\">取 消</el-button>\r\n                <el-button type=\"primary\" @click=\"handleExit()\">确 定</el-button>\r\n            </div>\r\n        </el-dialog>\r\n\r\n        <h1 class=\"username-style\">{{ username }}</h1>\r\n<!--        <div class=\"demo-basic&#45;&#45;circle\" style=\"position: relative; top: -50px; left: 30%;\">-->\r\n<!--            <div class=\"block\"><el-avatar size=\"40\" icon=\"el-icon-user-solid\"></el-avatar></div>-->\r\n<!--            <div class=\"block\" v-for=\"size in sizeList\" :key=\"size\">-->\r\n<!--                <el-avatar size=\"size\" icon=\"el-icon-user-solid\"></el-avatar>-->\r\n<!--            </div>-->\r\n<!--        </div>-->\r\n\r\n        <el-table :data=\"tableData\" stripe border class=\"table-style\">\r\n            <el-table-column label=\"编辑选项\" prop=\"type\" width=\"160\">\r\n            </el-table-column>\r\n            <el-table-column label=\"内容\" prop=\"data\" width=\"280\">\r\n            </el-table-column>\r\n            <el-table-column label=\"操作\" width=\"220\">\r\n                <template slot-scope=\"scope\">\r\n                    <el-button size=\"mini\" @click=\"handleEditButton(scope.$index, scope.row)\">编辑</el-button>\r\n                </template>\r\n\r\n            </el-table-column>\r\n        </el-table>\r\n        <br><br>\r\n        <el-button @click=\"passwordDialogVisible = true\" class=\"editpassword-style\">修改密码</el-button>\r\n\r\n        <el-dialog title=\"修改密码\" :visible.sync=\"passwordDialogVisible\">\r\n            <el-form :model=\"form\">\r\n                <el-form-item label=\"请输入原始密码\" :label-width=\"formLabelWidth\">\r\n                    <el-input v-model=\"comfirmPassword\" autocomplete=\"off\"></el-input>\r\n                </el-form-item>\r\n                <el-form-item label=\"请输入新密码\" :label-width=\"formLabelWidth\">\r\n                    <el-input v-model=\"newPassword\" autocomplete=\"off\"></el-input>\r\n                </el-form-item>\r\n                <el-form-item label=\"请再次输入新密码\" :label-width=\"formLabelWidth\">\r\n                    <el-input v-model=\"newPasswordAgain\" autocomplete=\"off\"></el-input>\r\n                </el-form-item>\r\n            </el-form>\r\n            <div slot=\"footer\" class=\"dialog-footer\">\r\n                <el-button @click=\"dialogFormVisible = false\">取 消</el-button>\r\n                <el-button type=\"primary\" @click=\"handleEditPassword()\">确 定</el-button>\r\n            </div>\r\n        </el-dialog>\r\n\r\n        <el-dialog title=\"编辑\" :visible.sync=\"dialogFormVisible\">\r\n            <el-form :model=\"form\">\r\n                <el-form-item :label=\"editRow\" :label-width=\"formLabelWidth\">\r\n                    <el-input v-model=\"editContent\" autocomplete=\"off\"></el-input>\r\n                </el-form-item>\r\n            </el-form>\r\n            <div slot=\"footer\" class=\"dialog-footer\">\r\n                <el-button @click=\"dialogFormVisible = false\">取 消</el-button>\r\n                <el-button type=\"primary\" @click=\"handleEdit()\">确 定</el-button>\r\n            </div>\r\n        </el-dialog>\r\n    </div>\r\n</template>\r\n\r\n<style scoped>\r\n.body {\r\n    position: absolute;\r\n    top: 0px;\r\n    left: 0px;\r\n    right: 0px;\r\n    bottom: 0px;\r\n    width: auto;\r\n    height: auto;\r\n    background-image: url(\"../../assets/userbackground.png\");\r\n    background-size: cover;\r\n    z-index: 0;\r\n}\r\n\r\n.username-style {\r\n    position: absolute;\r\n    top: 2px;\r\n    right: 130px;\r\n    font-size: 25px;\r\n    color: #fff;\r\n}\r\n\r\n.table-style {\r\n    position: absolute;\r\n    top: 35%;\r\n    left: 42%;\r\n    float: left;\r\n    width: auto;\r\n    font-family: 'Exo', sans-serif;\r\n    font-size: 18px;\r\n}\r\n\r\n.exit-style {\r\n    position: absolute;\r\n    top: 17px;\r\n    right: 12px;\r\n}\r\n\r\n.editpassword-style {\r\n    position: absolute;\r\n    top: 70%;\r\n    left: 70%;\r\n    float: left;\r\n    font-family: 'Exo', sans-serif;\r\n    font-size: 18px;\r\n}\r\n</style>\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}