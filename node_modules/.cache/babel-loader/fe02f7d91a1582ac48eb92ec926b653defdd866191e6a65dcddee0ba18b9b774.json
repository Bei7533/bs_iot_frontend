{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport * as echarts from 'echarts';\nexport default {\n  data() {\n    return {\n      username: this.$route.query.username,\n      activeIndex: '1',\n      activeIndex2: '1',\n      deviceNum: '',\n      tableData: [],\n      stringList: [],\n      onlineDeviceNum: 0,\n      allMessageNum: 0\n    };\n  },\n  mounted() {\n    this.fetchData(); // 在组件挂载后调用发送请求的方法\n  },\n\n  methods: {\n    handleSelect(key, keyPath) {\n      if (key === '1-1') {\n        // alert('1-1')\n        this.$router.push({\n          path: '/user/userinfo',\n          query: {\n            username: this.username\n          }\n        });\n      } else if (key === '1-2') {\n        this.$router.push({\n          path: '/user/userinfoedit',\n          query: {\n            username: this.username\n          }\n        });\n      } else if (key === '2') {\n        this.$router.push({\n          path: '/user/map',\n          query: {\n            username: this.username\n          }\n        });\n      } else if (key === '3') {\n        this.$router.push({\n          path: '/user/device',\n          query: {\n            username: this.username\n          }\n        });\n      } else if (key === '4') {\n        this.$router.push({\n          // path: '/user/data',\n          // query: { username: this.username }\n        });\n      }\n    },\n    fetchData() {\n      this.$axios.post('http://localhost:8088/admin/deviceinfo', {\n        username: this.username\n      }).then(successResponse => {\n        if (successResponse.data.code === 200) {\n          this.deviceNum = successResponse.data.message;\n          console.log(this.deviceNum);\n          this.stringList = successResponse.data.stringList;\n          this.tableData = [];\n          for (let i = 0; i < this.deviceNum; i++) {\n            let device_str = this.stringList[i];\n            let device_id = device_str.substring(device_str.indexOf('id') + 3, device_str.indexOf(','));\n            this.tableData.push({\n              id: device_id,\n              device_name: device_str.substring(device_str.indexOf('device_name') + 12, device_str.indexOf('device_type') - 2),\n              device_type: device_str.substring(device_str.indexOf('device_type') + 12, device_str.indexOf('device_discript') - 2),\n              device_discript: device_str.substring(device_str.indexOf('device_discript') + 16, device_str.indexOf('create_time') - 2),\n              create_time: device_str.substring(device_str.indexOf('create_time') + 12, device_str.length - 2)\n            });\n            this.$axios.post('http://localhost:8088/admin/devicemessage', {\n              device_id: device_id\n            }).then(successResponse => {\n              if (successResponse.data.code === 200) {\n                this.allMessageNum += parseInt(successResponse.data.message);\n                if (successResponse.data.data === \"true\") this.onlineDeviceNum += 1;\n                console.log(this.allMessageNum);\n                console.log(successResponse.data.data);\n              }\n            });\n          }\n        } else if (successResponse.data.code === 404) {\n          alert('访问用户失败');\n        }\n      }).catch(failResponse => {});\n    }\n  }\n};","map":{"version":3,"names":["echarts","data","username","$route","query","activeIndex","activeIndex2","deviceNum","tableData","stringList","onlineDeviceNum","allMessageNum","mounted","fetchData","methods","handleSelect","key","keyPath","$router","push","path","$axios","post","then","successResponse","code","message","console","log","i","device_str","device_id","substring","indexOf","id","device_name","device_type","device_discript","create_time","length","parseInt","alert","catch","failResponse"],"sources":["src/views/device/Data.vue"],"sourcesContent":["<script>\r\nimport * as echarts from 'echarts'\r\nexport default {\r\n  data() {\r\n    return {\r\n      username: this.$route.query.username,\r\n      activeIndex: '1',\r\n      activeIndex2: '1',\r\n      deviceNum: '',\r\n      tableData: [],\r\n      stringList: [],\r\n      onlineDeviceNum: 0,\r\n      allMessageNum: 0\r\n    };\r\n  },\r\n  mounted() {\r\n    this.fetchData(); // 在组件挂载后调用发送请求的方法\r\n  },\r\n  methods: {\r\n    handleSelect(key, keyPath) {\r\n      if (key === '1-1') {\r\n        // alert('1-1')\r\n        this.$router.push({\r\n          path: '/user/userinfo',\r\n          query: { username: this.username }\r\n        });\r\n      } else if (key === '1-2') {\r\n        this.$router.push({\r\n          path: '/user/userinfoedit',\r\n          query: { username: this.username }\r\n        });\r\n      } else if (key === '2') {\r\n        this.$router.push({\r\n          path: '/user/map',\r\n          query: { username: this.username }\r\n        });\r\n      } else if (key === '3') {\r\n        this.$router.push({\r\n          path: '/user/device',\r\n          query: { username: this.username }\r\n        });\r\n      } else if (key === '4') {\r\n        this.$router.push({\r\n          // path: '/user/data',\r\n          // query: { username: this.username }\r\n        });\r\n      }\r\n    },\r\n    fetchData() {\r\n      this.$axios\r\n          .post('http://localhost:8088/admin/deviceinfo', {\r\n            username: this.username,\r\n          })\r\n          .then(successResponse => {\r\n            if (successResponse.data.code === 200) {\r\n              this.deviceNum = successResponse.data.message;\r\n              console.log(this.deviceNum)\r\n              this.stringList = successResponse.data.stringList;\r\n              this.tableData = []\r\n\r\n              for (let i = 0; i < this.deviceNum; i++) {\r\n                let device_str = this.stringList[i];\r\n                let device_id = device_str.substring(device_str.indexOf('id') + 3, device_str.indexOf(','));\r\n                this.tableData.push({\r\n                  id: device_id,\r\n                  device_name: device_str.substring(device_str.indexOf('device_name') + 12, device_str.indexOf('device_type') - 2),\r\n                  device_type: device_str.substring(device_str.indexOf('device_type') + 12, device_str.indexOf('device_discript') - 2),\r\n                  device_discript: device_str.substring(device_str.indexOf('device_discript') + 16, device_str.indexOf('create_time') - 2),\r\n                  create_time: device_str.substring(device_str.indexOf('create_time') + 12, device_str.length - 2),\r\n                });\r\n\r\n                this.$axios\r\n                    .post('http://localhost:8088/admin/devicemessage', {\r\n                      device_id: device_id,\r\n                    })\r\n                    .then(successResponse => {\r\n                      if (successResponse.data.code === 200) {\r\n                        this.allMessageNum += parseInt(successResponse.data.message) ;\r\n                        if(successResponse.data.data === \"true\")\r\n                          this.onlineDeviceNum += 1 ;\r\n                        console.log(this.allMessageNum)\r\n                        console.log(successResponse.data.data)\r\n                      }\r\n                    });\r\n              }\r\n            } else if (successResponse.data.code === 404) {\r\n              alert('访问用户失败')\r\n            }\r\n          })\r\n          .catch(failResponse => {\r\n          });\r\n    },\r\n  }\r\n\r\n}\r\n</script>\r\n\r\n<template>\r\n  <div class=\"body\">\r\n\r\n    <el-menu :default-active=\"activeIndex2\" class=\"el-menu-demo\" mode=\"horizontal\" @select=\"handleSelect\"\r\n      background-color=\"#2A7A88\" text-color=\"#fff\" active-text-color=\"#ffd04b\">\r\n      <el-submenu index=\"1\">\r\n        <template slot=\"title\">\r\n          <i class=\"el-icon-user\"></i>\r\n          <span>个人信息</span>\r\n        </template>\r\n        <el-menu-item index=\"1-1\">查看信息</el-menu-item>\r\n        <el-menu-item index=\"1-2\">编辑信息</el-menu-item>\r\n      </el-submenu>\r\n      <el-menu-item index=\"2\">\r\n        <template slot=\"title\">\r\n          <i class=\"el-icon-map-location\"></i>\r\n          <span slot=\"title\">查看地图</span>\r\n        </template>\r\n      </el-menu-item>\r\n      <el-menu-item index=\"3\">\r\n        <i class=\"el-icon-setting\"></i>\r\n        <span slot=\"title\">设备管理</span>\r\n      </el-menu-item>\r\n      <el-menu-item index=\"4\">\r\n        <i class=\"el-icon-data-line\"></i>\r\n        <span slot=\"title\">数据统计</span>\r\n      </el-menu-item>\r\n    </el-menu>\r\n    <h1 class=\"username-style\">{{ username }}</h1>\r\n    <div class=\"demo-basic--circle\" style=\"position: absolute; top: 12px; right: 150px;\">\r\n      <div class=\"block\"><el-avatar size=\"40\" icon=\"el-icon-user-solid\"></el-avatar></div>\r\n      <div class=\"block\" v-for=\"size in sizeList\" :key=\"size\">\r\n        <el-avatar size=\"size\" icon=\"el-icon-user-solid\"></el-avatar>\r\n      </div>\r\n    </div>\r\n    <div class=\"top-style\">\r\n      <el-row :gutter=\"22\">\r\n        <el-col :span=\"4\">\r\n          <div>\r\n            <el-statistic title=\"用户名\">\r\n              <template slot=\"formatter\">\r\n                {{ username }}\r\n              </template>\r\n            </el-statistic>\r\n          </div>\r\n        </el-col>\r\n        <el-col :span=\"4\">\r\n          <div>\r\n            <el-statistic title=\"设备总数\">\r\n              <template slot=\"formatter\">\r\n                {{ deviceNum }}\r\n              </template>\r\n            </el-statistic>\r\n          </div>\r\n        </el-col>\r\n        <el-col :span=\"4\">\r\n          <div>\r\n            <el-statistic title=\"当前在线数量\">\r\n              <template slot=\"formatter\">\r\n                {{ onlineDeviceNum }}\r\n              </template>\r\n            </el-statistic>\r\n          </div>\r\n        </el-col>\r\n        <el-col :span=\"4\">\r\n          <div>\r\n            <el-statistic title=\"当前消息总数\">\r\n              <template slot=\"formatter\">\r\n                {{ allMessageNum }}\r\n              </template>\r\n            </el-statistic>\r\n          </div>\r\n        </el-col>\r\n      </el-row>\r\n    </div>\r\n  <div id=\"type_chart\"></div>\r\n  </div>\r\n</template>\r\n\r\n<style scoped>\r\n.body {\r\n  position: absolute;\r\n  top: 0px;\r\n  left: 0px;\r\n  right: 0px;\r\n  bottom: 0px;\r\n  width: auto;\r\n  height: auto;\r\n  //background-image: url(\"../../assets/fakedata.png\");\r\n  //background-size: cover;\r\n  z-index: 0;\r\n}\r\n\r\n.username-style {\r\n  position: absolute;\r\n  top: 2px;\r\n  right: 65px;\r\n  font-size: 25px;\r\n  color: #fff;\r\n}\r\n\r\n.top-style {\r\n  position: absolute;\r\n  top: 18%;\r\n  left: 5%;\r\n  width: 80%;\r\n  font-family: 'Exo', sans-serif;\r\n  font-size: 28px;\r\n}\r\n</style>\r\n"],"mappings":";AACA,YAAAA,OAAA;AACA;EACAC,KAAA;IACA;MACAC,QAAA,OAAAC,MAAA,CAAAC,KAAA,CAAAF,QAAA;MACAG,WAAA;MACAC,YAAA;MACAC,SAAA;MACAC,SAAA;MACAC,UAAA;MACAC,eAAA;MACAC,aAAA;IACA;EACA;EACAC,QAAA;IACA,KAAAC,SAAA;EACA;;EACAC,OAAA;IACAC,aAAAC,GAAA,EAAAC,OAAA;MACA,IAAAD,GAAA;QACA;QACA,KAAAE,OAAA,CAAAC,IAAA;UACAC,IAAA;UACAhB,KAAA;YAAAF,QAAA,OAAAA;UAAA;QACA;MACA,WAAAc,GAAA;QACA,KAAAE,OAAA,CAAAC,IAAA;UACAC,IAAA;UACAhB,KAAA;YAAAF,QAAA,OAAAA;UAAA;QACA;MACA,WAAAc,GAAA;QACA,KAAAE,OAAA,CAAAC,IAAA;UACAC,IAAA;UACAhB,KAAA;YAAAF,QAAA,OAAAA;UAAA;QACA;MACA,WAAAc,GAAA;QACA,KAAAE,OAAA,CAAAC,IAAA;UACAC,IAAA;UACAhB,KAAA;YAAAF,QAAA,OAAAA;UAAA;QACA;MACA,WAAAc,GAAA;QACA,KAAAE,OAAA,CAAAC,IAAA;UACA;UACA;QAAA,CACA;MACA;IACA;IACAN,UAAA;MACA,KAAAQ,MAAA,CACAC,IAAA;QACApB,QAAA,OAAAA;MACA,GACAqB,IAAA,CAAAC,eAAA;QACA,IAAAA,eAAA,CAAAvB,IAAA,CAAAwB,IAAA;UACA,KAAAlB,SAAA,GAAAiB,eAAA,CAAAvB,IAAA,CAAAyB,OAAA;UACAC,OAAA,CAAAC,GAAA,MAAArB,SAAA;UACA,KAAAE,UAAA,GAAAe,eAAA,CAAAvB,IAAA,CAAAQ,UAAA;UACA,KAAAD,SAAA;UAEA,SAAAqB,CAAA,MAAAA,CAAA,QAAAtB,SAAA,EAAAsB,CAAA;YACA,IAAAC,UAAA,QAAArB,UAAA,CAAAoB,CAAA;YACA,IAAAE,SAAA,GAAAD,UAAA,CAAAE,SAAA,CAAAF,UAAA,CAAAG,OAAA,YAAAH,UAAA,CAAAG,OAAA;YACA,KAAAzB,SAAA,CAAAW,IAAA;cACAe,EAAA,EAAAH,SAAA;cACAI,WAAA,EAAAL,UAAA,CAAAE,SAAA,CAAAF,UAAA,CAAAG,OAAA,sBAAAH,UAAA,CAAAG,OAAA;cACAG,WAAA,EAAAN,UAAA,CAAAE,SAAA,CAAAF,UAAA,CAAAG,OAAA,sBAAAH,UAAA,CAAAG,OAAA;cACAI,eAAA,EAAAP,UAAA,CAAAE,SAAA,CAAAF,UAAA,CAAAG,OAAA,0BAAAH,UAAA,CAAAG,OAAA;cACAK,WAAA,EAAAR,UAAA,CAAAE,SAAA,CAAAF,UAAA,CAAAG,OAAA,sBAAAH,UAAA,CAAAS,MAAA;YACA;YAEA,KAAAlB,MAAA,CACAC,IAAA;cACAS,SAAA,EAAAA;YACA,GACAR,IAAA,CAAAC,eAAA;cACA,IAAAA,eAAA,CAAAvB,IAAA,CAAAwB,IAAA;gBACA,KAAAd,aAAA,IAAA6B,QAAA,CAAAhB,eAAA,CAAAvB,IAAA,CAAAyB,OAAA;gBACA,IAAAF,eAAA,CAAAvB,IAAA,CAAAA,IAAA,aACA,KAAAS,eAAA;gBACAiB,OAAA,CAAAC,GAAA,MAAAjB,aAAA;gBACAgB,OAAA,CAAAC,GAAA,CAAAJ,eAAA,CAAAvB,IAAA,CAAAA,IAAA;cACA;YACA;UACA;QACA,WAAAuB,eAAA,CAAAvB,IAAA,CAAAwB,IAAA;UACAgB,KAAA;QACA;MACA,GACAC,KAAA,CAAAC,YAAA,KACA;IACA;EACA;AAEA"},"metadata":{},"sourceType":"module","externalDependencies":[]}